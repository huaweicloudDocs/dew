# 大量数据加密<a name="dew_01_0006"></a>

当有大量数据（例如：照片、视频或者数据库文件等）需要加解密时，用户可采用信封加密方式加解密数据，无需通过网络传输大量数据即可完成数据加解密。

## 加密本地文件<a name="section05751786563"></a>

加密本地文件流程，如[图1](#fig614411513111)所示。

**图 1**  加密本地文件<a name="fig614411513111"></a>  
![](figures/加密本地文件.png "加密本地文件")

流程说明如下：

1.  用户需要在KMS中创建一个用户主密钥。
2.  用户调用KMS的“create-datakey“接口创建数据加密密钥。用户得到一个明文的数据加密密钥和一个密文的数据加密密钥。其中密文的数据加密密钥是由指定的用户主密钥加密明文的数据加密密钥生成的。
3.  用户使用明文的数据加密密钥来加密明文文件，生成密文文件。
4.  用户将密文的数据加密密钥和密文文件一同存储到持久化存储设备或服务中。

## 解密本地文件<a name="section5961359195612"></a>

解密本地文件流程，如[图2](#fig14144185113115)所示。

**图 2**  解密本地文件<a name="fig14144185113115"></a>  
![](figures/解密本地文件.png "解密本地文件")

流程说明如下：

1.  用户从持久化存储设备或服务中读取密文的数据加密密钥和密文文件。
2.  用户调用KMS的“decrypt-datakey“接口，使用对应的用户主密钥（即生成密文的数据加密密钥时所使用的用户主密钥）来解密密文的数据加密密钥，取得明文的数据加密密钥。

    若对应的用户主密钥被误删除，会导致解密失败。因此，需要妥善管理好用户主密钥。

3.  用户使用明文的数据加密密钥来解密密文文件。

